<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: maiastatistics.maia</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: maiastatistics.maia</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>#!/usr/bin/env maiascript

///
/// @license
/// Copyright 2020 Roberto Luiz Souza Monteiro,
///                Renata Souza Barreto,
///                Hernane Borges de Barros Pereira.
///
/// Licensed under the Apache License, Version 2.0 (the "License")
/// you may not use this file except in compliance with the License.
/// You may obtain a copy of the License at
///
///   http://www.apache.org/licenses/LICENSE-2.0
///
/// Unless required by applicable law or agreed to in writing, software
/// distributed under the License is distributed on an "AS IS" BASIS,
/// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, eitherMath.express or implied.
/// See the License for the specific language governing permissions and
/// limitations under the License.
///

///
/// MaiaApp core class.
/// @namespace maiastatistics
///
namespace maiastatistics {
    appTitle = "MaiaStatistics"
    appName = "maiastatistics"
    scriptPath = "./"
    dfaLibrary = this.scriptPath + "/maia/dfa/dfa.maia"
    
    /// Starts the application and processes the data passed as command line arguments.
    /// @method run
    /// @memberof maiastatistics
    function run() {
        // Supports only the Node.js interpreter.
        if (core.type(process) != "undefined") {
            command = "node"
            fs = system.require("fs")
            realPath = fs.realpathSync(system.argv[0])
            filePath = realPath.split("/")
            filePath = core.slice(filePath, 0, filePath.length - 2)
            filePath = filePath.join("/")
            this.scriptPath = filePath
            this.dfaLibrary = this.scriptPath + "/maia/dfa/dfa.maia"
            system.source(this.dfaLibrary)
            this.statisticsLibrary = this.scriptPath + "/maia/statistics/statistics.maia"
            system.source(this.statisticsLibrary)
            readTextFile = fs.readFileSync
            // Read file callback.
            function readFile(input) {
                content = readTextFile(input, "utf-8")
                return(content)
            }            
            // Command line options.
            inputFile = ""
            inputFile1 = ""
            inputFile2 = ""
            outputFile = ""
            outputAverageFile = ""
            outputDeviationFile = ""
            outputErrorFile = ""
            outputSumFile = ""
            fileType = "png"
            reportFile = ""
            firstLine = 0
            lastLine = ""
            numberOfLines = ""
            separator = ","            
            prefix = "sample"
            nFiles = 1
            indexFrom = 1
            indexTo = 1
            indexIn = 1
            separateColumn = false
            columnNumber = 0
            replaceGivenPattern = false
            patternString = ""
            replacementString = ""
            splitFile = false
            nFirst = 1
            normalizeData = false
            denormalizeData = false
            minimum = ""
            maximum = ""
            nextStep = false
            steps = 1
            calculateAverage = false
            calculateSum = false
            calculatePearson = false
            calculateLSQR = false
            calculateDFA = false
            calculateDCCA = false
            calculateRhoDCCA = false
            plotChart = false
            width = 1280
            height = 720
            backgroundColor = "white"
            commandOptions = ""
            minbox = 0
            maxbox = 0
            rsmode = "peng"
            mavg = false
            nfit = 2
            sw = 0
            // Get command line arguments.
            if (system.argc > 1) {
                i = 1
                while (i &lt; system.argc) {
                    if ((system.argv[i] == "-h") | (system.argv[i] == "--help")) {
                        system.log(maiastatistics.appTitle + " Command Line Interface (CLI)")
                        system.log("Usage: " + maiastatistics.appName + " [options] [input file] [--] [arguments]")
                        system.log("Options:")
                        system.log("-h     --help               Displays this help message.")
                        system.log("-i     [input file]         Input file name.")
                        system.log("-o     [output file]        Output file name.")
                        system.log("-t                          File output format.")
                        system.log("-r                          Statistics report file.")
                        system.log("       --i1                 Input CSV file name 1.")
                        system.log("       --i2                 Input CSV file name 2.")
                        system.log("       --oavg               Average output CSV file.")
                        system.log("       --odev               Standard deviation output CSV file.")
                        system.log("       --oerr               Standard error output CSV file.")
                        system.log("       --osum               Sums output CSV file.")
                        system.log("       --first              First line to read from CSV file.")
                        system.log("       --last               Last line to read from CSV file.")
                        system.log("       --lines              Number of lines to read from CSV file.")
                        system.log("       --separator          Training set files column separator(default=,).")
                        system.log("       --prefix             Prefix for multiple neural network files (default=sample).")
                        system.log("       --nfiles             Number of files for multiple neural network files.")
                        system.log("       --from               First file index for multiple neural network files.")
                        system.log("       --to                 Last file index for multiple neural network files.")
                        system.log("       --in                 Total number of files in the file set.")
                        system.log("       --column             Creates a new time series containing only the specified column.")
                        system.log("       --replace            Replace lines whit pattern in a time series with a given value.")
                        system.log("       --with               Replacement value for the given pattern.")
                        system.log("       --split              Split a file into two parts.")
                        system.log("       --nfirst             Number of lines of the first file to split.")
                        system.log("       --normalize          Normalizes a time series.")
                        system.log("       --denormalize        Denormalizes a time series.")
                        system.log("       --minimum            The minimum value of the time series.")
                        system.log("       --maximum            The maximum value of the time series.")
                        system.log("       --nextstep           Creates a new series containing the next steps for each value of the given series.")
                        system.log("       --steps              Number of next steps.")
                        system.log("       --avg                Calculates the mean values, standard deviations or standard errors of cells from multiple CSV files.")
                        system.log("       --sum                Calculates the sums of cells from multiple CSV files.")
                        system.log("       --plot               Draw a graphic and save it in PNG format.")
                        system.log("       --width              Chart width.")
                        system.log("       --height             Chart height.")
                        system.log("       --background         Chart background color.")
                        system.log("       --options            Commnand options.")
                        system.log("       --pearson            Calculates the Pearson coefficient.")
                        system.log("       --lsqr               Calculates the best curve that approximates a set of points, using the least squares method.")
                        system.log("       --dfa                Calculates the DFA.")
                        system.log("       --minbox             The minimum box size for DFA.")
                        system.log("       --maxbox             The maximum box size for DFA.")
                        system.log("       --rsmode             The algorithm for scaling for DFA.")
                        system.log("       --mavg               Remove the average from the series for DFA.")
                        system.log("       --nfit               The order of the regression fit for DFA.")
                        system.log("       --sw                 The sliding window mode for DFA.")
                        system.log("       --dcca               Calculates the DCCA.")
                        system.log("       --rhodcca            Calculates the rhoDCCA.")
                        process.exit(0)
                    } elseif (system.argv[i] == "-i") {
                        i = i + 1
                        inputFile = system.argv[i]
                    } elseif (system.argv[i] == "-o") {
                        i = i + 1
                        outputFile = system.argv[i]
                    } elseif (system.argv[i] == "-t") {
                        i = i + 1
                        fileType = system.argv[i]
                    } elseif (system.argv[i] == "-r") {
                        i = i + 1
                        reportFile = system.argv[i]
                    } elseif (system.argv[i] == "--i1") {
                        i = i + 1
                        inputFile1 = system.argv[i]
                    } elseif (system.argv[i] == "--i2") {
                        i = i + 1
                        inputFile2 = system.argv[i]
                    } elseif (system.argv[i] == "--oavg") {
                        i = i + 1
                        outputAverageFile = system.argv[i]
                    } elseif (system.argv[i] == "--odev") {
                        i = i + 1
                        outputDeviationFile = system.argv[i]
                    } elseif (system.argv[i] == "--oerr") {
                        i = i + 1
                        outputErrorFile = system.argv[i]
                    } elseif (system.argv[i] == "--osum") {
                        i = i + 1
                        outputSumFile = system.argv[i]
                    } elseif (system.argv[i] == "--first") {
                        i = i + 1
                        firstLine = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--last") {
                        i = i + 1
                        lastLine = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--lines") {
                        i = i + 1
                        numberOfLines = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--separator") {
                        i = i + 1
                        separator = system.argv[i]
                    } elseif (system.argv[i] == "--avgdeg") {
                        i = i + 1
                        avgdeg = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--prefix") {
                        i = i + 1
                        prefix = system.argv[i]
                    } elseif (system.argv[i] == "--nfiles") {
                        i = i + 1
                        nFiles = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--from") {
                        i = i + 1
                        indexFrom = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--to") {
                        i = i + 1
                        indexTo = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--in") {
                        i = i + 1
                        indexIn = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--column") {
                        i = i + 1
                        columnNumber = system.argv[i]
                        separateColumn = true
                    } elseif (system.argv[i] == "--replace") {
                        i = i + 1
                        patternString = system.argv[i]
                        replaceGivenPattern = true
                    } elseif (system.argv[i] == "--with") {
                        i = i + 1
                        replacementString = system.argv[i]
                    } elseif (system.argv[i] == "--split") {
                        splitFile = true
                    } elseif (system.argv[i] == "--nfirst") {
                        i = i + 1
                        nFirst = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--normalize") {
                        normalizeData = true
                    } elseif (system.argv[i] == "--denormalize") {
                        denormalizeData = true
                    } elseif (system.argv[i] == "--minimum") {
                        i = i + 1
                        minimum = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--maximum") {
                        i = i + 1
                        maximum = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--nextstep") {
                        nextStep = true
                    } elseif (system.argv[i] == "--steps") {
                        i = i + 1
                        steps = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--avg") {
                        calculateAverage = true
                    } elseif (system.argv[i] == "--sum") {
                        calculateSum = true
                    } elseif (system.argv[i] == "--plot") {
                        plotChart = true
                    } elseif (system.argv[i] == "--width") {
                        i = i + 1
                        width = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--height") {
                        i = i + 1
                        height = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--background") {
                        i = i + 1
                        backgroundColor = system.argv[i]
                    } elseif (system.argv[i] == "--options") {
                        i = i + 1
                        commandOptions = system.argv[i]
                    } elseif (system.argv[i] == "--pearson") {
                        calculatePearson = true
                    } elseif (system.argv[i] == "--lsqr") {
                        calculateLSQR = true
                    } elseif (system.argv[i] == "--dfa") {
                        calculateDFA = true
                    } elseif (system.argv[i] == "--minbox") {
                        i = i + 1
                        minbox = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--maxbox") {
                        i = i + 1
                        maxbox = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--rsmode") {
                        i = i + 1
                        rsmode = system.argv[i]
                    } elseif (system.argv[i] == "--mavg") {
                        mavg = true
                    } elseif (system.argv[i] == "--nfit") {
                        i = i + 1
                        nfit = core.toNumber(system.argv[i])
                    } elseif (system.argv[i] == "--sw") {
                        sw = 1
                    } elseif (system.argv[i] == "--dcca") {
                        calculateDCCA = true
                    } elseif (system.argv[i] == "--rhodcca") {
                        calculateRhoDCCA = true
                    } else {
                        if (inputFile == "") {
                            inputFile = system.argv[i]
                        } else {
                            inputFile1 = inputFile
                            inputFile2 = system.argv[i]
                        }
                    }
                    i = i + 1
                }
                if (separateColumn) {
                    // Get the file without extension.
                    fileName = inputFile.split(".")
                    fileName = fileName.shift()
                    // Get the file name extension.
                    fileExtension = inputFile.split(".")
                    fileExtension = fileExtension.pop()
                    if (outputFile == "") {
                        outputFile = fileName + "-column-" + core.toString(columnNumber) + "." + fileExtension
                    }
                    inputData = system.loadCSV(inputFile, firstLine, separator, true, true)
                    outputData = statistics.getColumn(inputData, columnNumber)
                    fileContents = system.createCSV(outputData, separator)
                    fs.writeFileSync(outputFile, fileContents)
                } elseif (replaceGivenPattern) {
                    // Get the file without extension.
                    fileName = inputFile.split(".")
                    fileName = fileName.shift()
                    // Get the file name extension.
                    fileExtension = inputFile.split(".")
                    fileExtension = fileExtension.pop()
                    if (outputFile == "") {
                        outputFile = fileName + "-replaced." + fileExtension
                    }

                    inputData = system.loadCSV(inputFile, firstLine, separator, true, false)
                    outputData = statistics.replacePattern(inputData, patternString, replacementString, true)

                    fileContents = system.createCSV(outputData, separator)
                    fs.writeFileSync(outputFile, fileContents)
                } elseif (splitFile) {
                    // Get the file without extension.
                    fileName = inputFile.split(".")
                    fileName = fileName.shift()
                    // Get the file name extension.
                    fileExtension = inputFile.split(".")
                    fileExtension = fileExtension.pop()

                    inputData = system.loadCSV(inputFile, firstLine, separator, true, false)
                    outputData = statistics.splitData(inputData, nFirst)

                    outputFile1 = fileName + "-" + core.toString(outputData.part1.length) + "." + fileExtension
                    outputFile2 = fileName + "-" + core.toString(outputData.part2.length) + "." + fileExtension
                    fileContents1 = system.createCSV(outputData.part1, separator)
                    fileContents2 = system.createCSV(outputData.part2, separator)
                    fs.writeFileSync(outputFile1, fileContents1)
                    fs.writeFileSync(outputFile2, fileContents2)
                } elseif (normalizeData) {
                    // Get the file without extension.
                    fileName = inputFile.split(".")
                    fileName = fileName.shift()
                    // Get the file name extension.
                    fileExtension = inputFile.split(".")
                    fileExtension = fileExtension.pop()
                    if (outputFile == "") {
                        outputFile = fileName + "-normalized." + fileExtension
                    }

                    inputData = system.loadCSV(inputFile, firstLine, separator, true, true)
                    avgData = statistics.getAverage(inputData)
                    outputData = statistics.normalize(inputData, avgData.minimum, avgData.maximum)

                    fileContents = system.createCSV(outputData, separator)
                    fs.writeFileSync(outputFile, fileContents)

                    // Saves the report file.
                    reportFileContents = ""
                    reportFileContents = reportFileContents + "Average: " + core.toString(avgData.average) + "\n"
                    reportFileContents = reportFileContents + "Standard deviation: " + core.toString(avgData.deviation) + "\n"
                    reportFileContents = reportFileContents + "Standard error: " + core.toString(avgData.error) + "\n"
                    reportFileContents = reportFileContents + "Minimum value: "  + core.toString(avgData.minimum) + "\n"
                    reportFileContents = reportFileContents + "Maximum value: "  + core.toString(avgData.maximum) + "\n"
                    reportFileContents = reportFileContents + "Observations: "  + core.toString(avgData.n) + "\n"
                    if (reportFile == "") {
                        reportFile = fileName + "-report.txt"
                    }
                    fs.writeFileSync(reportFile, reportFileContents)
                } elseif (denormalizeData) {
                    if ((core.type(minimum) != "number") || (core.type(maximum) != "number")) {
                        system.log("To denormalize a time series you need to provide the minimum and maximum values of the original, denormalized series.")
                        process.exit()
                    }
                    // Get the file without extension.
                    fileName = inputFile.split(".")
                    fileName = fileName.shift()
                    // Get the file name extension.
                    fileExtension = inputFile.split(".")
                    fileExtension = fileExtension.pop()
                    if (outputFile == "") {
                        outputFile = fileName + "-denormalized." + fileExtension
                    }

                    inputData = system.loadCSV(inputFile, firstLine, separator, true, true)
                    outputData = statistics.denormalize(inputData, minimum, maximum)

                    fileContents = system.createCSV(outputData, separator)
                    fs.writeFileSync(outputFile, fileContents)
                } elseif (nextStep) {
                    // Get the file without extension.
                    fileName = inputFile.split(".")
                    fileName = fileName.shift()
                    // Get the file name extension.
                    fileExtension = inputFile.split(".")
                    fileExtension = fileExtension.pop()
                    if (outputFile == "") {
                        outputFile = fileName + "-steps." + fileExtension
                    }

                    inputData = system.loadCSV(inputFile, firstLine, separator, true, true)
                    outputData = statistics.getNextSteps(inputData, steps)

                    fileContents = system.createCSV(outputData, separator)
                    fs.writeFileSync(outputFile, fileContents)
                } elseif (calculateAverage) {
                    glob = system.require("glob")

                    files = glob.sync(inputFile)

                    if (files.length == 0) {
                        system.log(maiastatistics.appTitle + " Command Line Interface (CLI)")
                        system.log("Usage: " + maiastatistics.appName + " [options] [input file] [--] [arguments]")
                    } else {
                        system.log("Processing " + files.length + " files...")

                        mavg = []
                        mdev = []
                        merr = []
                        msx = []
                        msx2 = []
                        mn = []
                        
                        for (fileNumber = 0; fileNumber &lt; files.length; fileNumber = fileNumber + 1) {
                            // Get the full file name.
                            file = files[fileNumber]

                            system.log("Processing file '" + file + "'...")

                            // Get the file without extension.
                            fileName = file.split(".")
                            fileName = fileName.shift()
                            // Get the file name extension.
                            fileExtension = file.split(".")
                            fileExtension = fileExtension.pop()

                            if (outputAverageFile == "") {
                                outputAverageFile = "output-avg.csv"
                            }
                            if (outputDeviationFile == "") {
                                outputDeviationFile = "output-dev.csv"
                            }
                            if (outputErrorFile == "") {
                                outputErrorFile = "output-err.csv"
                            }
                            
                            inputData = system.loadCSV(file, firstLine, separator, true, true)
                            dimData = core.dim(inputData)
                            n = dimData[0]
                            m = dimData[1]
                            
                            // Creates the mavg, mdev, msx, msx2 and mn matrices.
                            if (mavg == []) {
                                mavg = core.matrix(0.0, n, m)
                                mdev = core.matrix(0.0, n, m)
                                merr = core.matrix(0.0, n, m)
                                msx = core.matrix(0.0, n, m)
                                msx2 = core.matrix(0.0, n, m)
                                mn = core.matrix(0.0, n, m)

                                if (numberOfLines == "") {
                                    numberOfLines = n
                                }
                                if (lastLine == "") {
                                    lastLine = firstLine + numberOfLines - 1
                                }
                            }

                            for (row = firstLine; row &lt;= lastLine; row = row + 1) {
                                for (col = 0; col &lt; m; col = col + 1) {
                                    x = inputData[row, col]
                                    msx[row, col] = msx[row, col] + x
                                    msx2[row, col] = msx2[row, col] + x * x
                                    mn[row, col] = mn[row, col] + 1
                                }
                            }
                        }
                        
                        // Calculates the averages, deviations and errors.
                        for (row = firstLine; row &lt;= lastLine; row = row + 1) {
                            for (col = 0; col &lt; m; col = col + 1) {
                                mavg[row, col] = msx[row, col] / mn[row, col]
                                mdev[row, col] = math.sqrt((msx2[row, col] - (msx[row, col] * msx[row, col]) / mn[row, col]) / (mn[row, col] - 1))
                                merr[row, col] = mdev[row, col] / math.sqrt(mn[row, col])
                            }
                        }

                        // Saves the output files.
                        averagefileContents = system.createCSV(mavg, separator)
                        fs.writeFileSync(outputAverageFile, averagefileContents)

                        deviationfileContents = system.createCSV(mdev, separator)
                        fs.writeFileSync(outputDeviationFile, deviationfileContents)

                        errorfileContents = system.createCSV(merr, separator)
                        fs.writeFileSync(outputErrorFile, errorfileContents)
                    }
                } elseif (calculateSum) {
                    glob = system.require("glob")

                    files = glob.sync(inputFile)

                    if (files.length == 0) {
                        system.log(maiastatistics.appTitle + " Command Line Interface (CLI)")
                        system.log("Usage: " + maiastatistics.appName + " [options] [input file] [--] [arguments]")
                    } else {
                        system.log("Processing " + files.length + " files...")

                        msum = []
                        
                        for (fileNumber = 0; fileNumber &lt; files.length; fileNumber = fileNumber + 1) {
                            // Get the full file name.
                            file = files[fileNumber]

                            system.log("Processing file '" + file + "'...")

                            // Get the file without extension.
                            fileName = file.split(".")
                            fileName = fileName.shift()
                            // Get the file name extension.
                            fileExtension = file.split(".")
                            fileExtension = fileExtension.pop()

                            if (outputSumFile == "") {
                                outputSumFile = "output-sum.csv"
                            }
                            
                            inputData = system.loadCSV(file, firstLine, separator, true, true)
                            dimData = core.dim(inputData)
                            n = dimData[0]
                            m = dimData[1]
                            
                            // Creates the msum matrix.
                            if (msum == []) {
                                msum = core.matrix(0.0, n, m)
                                
                                if (numberOfLines == "") {
                                    numberOfLines = n
                                }
                                if (lastLine == "") {
                                    lastLine = firstLine + numberOfLines - 1
                                }
                            }
                            
                            for (row = firstLine; row &lt;= lastLine; row = row + 1) {
                                for (col = 0; col &lt; m; col = col + 1) {
                                    x = inputData[row, col]
                                    msum[row, col] = msum[row, col] + x
                                }
                            }
                        }
                        
                        // Saves the output files.
                        sumfileContents = system.createCSV(msum, separator)
                        fs.writeFileSync(outputSumFile, sumfileContents)
                    }
                } elseif (plotChart) {
                    configuration = eval(readFile(inputFile))

                    statistics.createChart(outputFile, fileType, width, height, backgroundColor, configuration)
                } elseif (calculatePearson) {
                    glob = system.require("glob")

                    files = glob.sync(inputFile)

                    if (files.length == 0) {
                        system.log(maiastatistics.appTitle + " Command Line Interface (CLI)")
                        system.log("Usage: " + maiastatistics.appName + " [options] [input file] [--] [arguments]")
                    } else {
                        system.log("Processing " + files.length + " files...")

                        for (fileNumber = 0; fileNumber &lt; files.length; fileNumber = fileNumber + 1) {
                            // Get the full file name.
                            file = files[fileNumber]

                            system.log("Processing file '" + file + "'...")

                            // Get the file without extension.
                            fileName = file.split(".")
                            fileName = fileName.shift()
                            // Get the file name extension.
                            fileExtension = file.split(".")
                            fileExtension = fileExtension.pop()

                            inputData = system.loadCSV(file, firstLine, separator, true, true)
                            pearsonCoefficient = statistics.getPearson(inputData)

                            // Saves the report file.
                            reportFileContents = ""
                            reportFileContents = reportFileContents + "Pearson coefficient: " + pearsonCoefficient + "\n"
                            if (reportFile == "") {
                                reportFile = fileName + "-report-pearson.txt"
                            }
                            fs.writeFileSync(reportFile, reportFileContents)

                            reportFile = ""
                        }
                    }
                } elseif (calculateLSQR) {
                    glob = system.require("glob")

                    files = glob.sync(inputFile)

                    if (files.length == 0) {
                        system.log(maiastatistics.appTitle + " Command Line Interface (CLI)")
                        system.log("Usage: " + maiastatistics.appName + " [options] [input file] [--] [arguments]")
                    } else {
                        system.log("Processing " + files.length + " files...")

                        for (fileNumber = 0; fileNumber &lt; files.length; fileNumber = fileNumber + 1) {
                            // Get the full file name.
                            file = files[fileNumber]

                            system.log("Processing file '" + file + "'...")

                            // Get the file without extension.
                            fileName = file.split(".")
                            fileName = fileName.shift()
                            // Get the file name extension.
                            fileExtension = file.split(".")
                            fileExtension = fileExtension.pop()

                            inputData = system.loadCSV(file, firstLine, separator, true, true)

                            // Calculates the least squares fit.
                            lsqr = statistics.getLsqr(inputData)

                            // Saves the report file.
                            reportFileContents = ""
                            reportFileContents = reportFileContents + "y = a + b * x\n"
                            reportFileContents = reportFileContents + "a: " + lsqr.a + "\n"
                            reportFileContents = reportFileContents + "b: " + lsqr.b + "\n"
                            reportFileContents = reportFileContents + "r2: " + lsqr.r2 + "\n"
                            if (reportFile == "") {
                                reportFile = fileName + "-report-lsqr.txt"
                            }
                            fs.writeFileSync(reportFile, reportFileContents)
                            
                            reportFile = ""
                        }
                    }
                } elseif (calculateDFA) {
                    glob = system.require("glob")

                    files = glob.sync(inputFile)

                    if (files.length == 0) {
                        system.log(maiastatistics.appTitle + " Command Line Interface (CLI)")
                        system.log("Usage: " + maiastatistics.appName + " [options] [input file] [--] [arguments]")
                    } else {
                        system.log("Processing " + files.length + " files...")

                        for (fileNumber = 0; fileNumber &lt; files.length; fileNumber = fileNumber + 1) {
                            // Get the full file name.
                            file = files[fileNumber]

                            system.log("Processing file '" + file + "'...")

                            // Get the file without extension.
                            fileName = file.split(".")
                            fileName = fileName.shift()
                            // Get the file name extension.
                            fileExtension = file.split(".")
                            fileExtension = fileExtension.pop()
                            
                            if (outputFile == "") {
                                outputFile = fileName + "-dfa." + fileExtension
                            }

                            inputData = system.loadCSV(file, firstLine, separator, true, true)

                            // Define the boxes sizes.
                            npts = inputData.length
                            if (minbox &lt; 2 * nfit) {
                                minbox = 2 * nfit
                            }
                            if (maxbox == 0 || maxbox > math.round(npts / 4)) {
                                maxbox = math.round(npts / 4)
                            }
                            if (minbox > maxbox) {
                                temp = minbox
                                minbox = maxbox
                                maxbox = temp
                                if (minbox &lt; 2 * nfit) {
                                    minbox = 2 * nfit
                                }
                            }

                            // Create the scale matrix.
                            rs = dfa.getRScale(minbox, maxbox, math.pow(2.0, 1.0/8.0), rsmode)

                            // Calculates the cumulative sum.
                            cumulativeSum = dfa.getCumulativeSum(inputData, mavg)

                            // Calculates the DFA.
                            dfaObject = statistics.getDfa(cumulativeSum, nfit, rs, sw)
                            dfaData = dfaObject.dfa
                            lsqr = dfaObject.lsqr

                            // Saves the DFA data.
                            fileContents = system.createCSV(dfaData, separator)
                            fs.writeFileSync(outputFile, fileContents)

                            // Saves the report file.
                            reportFileContents = ""
                            reportFileContents = reportFileContents + "y = a + b * x\n"
                            reportFileContents = reportFileContents + "a: " + lsqr.a + "\n"
                            reportFileContents = reportFileContents + "b: " + lsqr.b + "\n"
                            reportFileContents = reportFileContents + "r2: " + lsqr.r2 + "\n"
                            if (reportFile == "") {
                                reportFile = fileName + "-report-lsqr.txt"
                            }
                            fs.writeFileSync(reportFile, reportFileContents)

                            outputFile = ""
                            reportFile = ""
                        }
                    }
                } elseif (calculateDCCA) {
                    glob = system.require("glob")

                    // Get the file 1 without extension.
                    fileName1 = inputFile1.split(".")
                    fileName1 = fileName1.shift()
                    // Get the file name extension.
                    fileExtension1 = inputFile1.split(".")
                    fileExtension1 = fileExtension1.pop()
                    
                    files = glob.sync(inputFile2)
                    
                    if (files.length == 0) {
                        system.log(maiastatistics.appTitle + " Command Line Interface (CLI)")
                        system.log("Usage: " + maiastatistics.appName + " [options] [input file] [--] [arguments]")
                    } else {
                        system.log("Processing " + files.length + " files...")

                        for (fileNumber = 0; fileNumber &lt; files.length; fileNumber = fileNumber + 1) {
                            // Get the full file name.
                            file = files[fileNumber]
                            
                            // Get the file without extension.
                            fileName2 = file.split(".")
                            fileName2 = fileName2.shift()
                            // Get the file name extension.
                            fileExtension2 = file.split(".")
                            fileExtension2 = fileExtension2.pop()

                            system.log("Processing files '" + inputFile1 + "' and '" + file + "'...")

                            // Sets the output file.
                            if (outputFile == "") {
                                outputFile = fileName2 + "-dcca.csv"
                            }

                            inputData1 = system.loadCSV(inputFile1, firstLine, separator, true, true)
                            inputData2 = system.loadCSV(file, firstLine, separator, true, true)

                            // Define the boxes sizes.
                            npts = inputData1.length
                            if (minbox &lt; 2 * nfit) {
                                minbox = 2 * nfit
                            }
                            if (maxbox == 0 || maxbox > math.round(npts / 4)) {
                                maxbox = math.round(npts / 4)
                            }
                            if (minbox > maxbox) {
                                temp = minbox
                                minbox = maxbox
                                maxbox = temp
                                if (minbox &lt; 2 * nfit) {
                                    minbox = 2 * nfit
                                }
                            }

                            // Create the scale matrix.
                            rs = dfa.getRScale(minbox, maxbox, math.pow(2.0, 1.0/8.0), rsmode)

                            // Calculates the cumulative sum.
                            cumulativeSum1 = dfa.getCumulativeSum(inputData1, mavg)
                            cumulativeSum2 = dfa.getCumulativeSum(inputData2, mavg)
                            
                            // Calculates the DCCA.
                            dccaData = statistics.getDcca(cumulativeSum1, cumulativeSum2, nfit, rs)

                            // Saves the DCCA data.
                            fileContents = system.createCSV(dccaData, separator)
                            fs.writeFileSync(outputFile, fileContents)

                            outputFile = ""
                        }
                    }
                } elseif (calculateRhoDCCA) {
                    glob = system.require("glob")

                    // Get the file 1 without extension.
                    fileName1 = inputFile1.split(".")
                    fileName1 = fileName1.shift()
                    // Get the file name extension.
                    fileExtension1 = inputFile1.split(".")
                    fileExtension1 = fileExtension1.pop()
                    
                    files = glob.sync(inputFile2)
                    
                    if (files.length == 0) {
                        system.log(maiastatistics.appTitle + " Command Line Interface (CLI)")
                        system.log("Usage: " + maiastatistics.appName + " [options] [input file] [--] [arguments]")
                    } else {
                        system.log("Processing " + files.length + " files...")

                        for (fileNumber = 0; fileNumber &lt; files.length; fileNumber = fileNumber + 1) {
                            // Get the full file name.
                            file = files[fileNumber]
                            
                            // Get the file without extension.
                            fileName2 = file.split(".")
                            fileName2 = fileName2.shift()
                            // Get the file name extension.
                            fileExtension2 = file.split(".")
                            fileExtension2 = fileExtension2.pop()

                            system.log("Processing files '" + inputFile1 + "' and '" + file + "'...")

                            // Sets the output file.
                            if (outputFile == "") {
                                outputFile = fileName2 + "-rhodcca.csv"
                            }

                            inputData1 = system.loadCSV(inputFile1, firstLine, separator, true, true)
                            inputData2 = system.loadCSV(file, firstLine, separator, true, true)

                            // Define the boxes sizes.
                            npts = inputData1.length
                            if (minbox &lt; 2 * nfit) {
                                minbox = 2 * nfit
                            }
                            if (maxbox == 0 || maxbox > math.round(npts / 4)) {
                                maxbox = math.round(npts / 4)
                            }
                            if (minbox > maxbox) {
                                temp = minbox
                                minbox = maxbox
                                maxbox = temp
                                if (minbox &lt; 2 * nfit) {
                                    minbox = 2 * nfit
                                }
                            }

                            // Create the scale matrix.
                            rs = dfa.getRScale(minbox, maxbox, math.pow(2.0, 1.0/8.0), rsmode)

                            // Calculates the cumulative sum.
                            cumulativeSum1 = dfa.getCumulativeSum(inputData1, mavg)
                            cumulativeSum2 = dfa.getCumulativeSum(inputData2, mavg)
                           
                            // Set sliding window.
                            sw = 1

                            // Calculates the DFA 1.
                            dfa1 = dfa.getDfa(cumulativeSum1, nfit, rs, sw)
                            
                            // Calculates the DFA 2.
                            dfa2 = dfa.getDfa(cumulativeSum2, nfit, rs, sw)
                            
                            // Calculates the DCCA.
                            dcca = dfa.getDcca(cumulativeSum1, cumulativeSum2, nfit, rs)
                            
                            // Calculates the rhoDCCA.
                            rhoDccaData = statistics.getRhoDcca(dfa1, dfa2, dcca)
                            
                            // Saves the rhoDCCA data.
                            fileContents = system.createCSV(rhoDccaData, separator)
                            fs.writeFileSync(outputFile, fileContents)

                            outputFile = ""
                        }
                    }
                } else {
                    system.log(maiastatistics.appTitle + " Command Line Interface (CLI)")
                    system.log("Usage: " + maiastatistics.appName + " [options] [input file] [--] [arguments]")
                }
            } else {
                system.log(maiastatistics.appTitle + " Command Line Interface (CLI)")
                system.log("Usage: " + maiastatistics.appName + " [options] [input file] [--] [arguments]")
            }
        }
    }
}
// Run the MaiaApp code if this script has been invoked
// from the command line.
if (core.type(process) != "undefined") {
    maiastatistics.run()
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="maiastatistics.html">maiastatistics</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Wed Aug 17 2022 14:48:51 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
